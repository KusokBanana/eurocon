$(document).ready(function(){var a=$(".pagination");$("body").on("click",".pagination a",function(g){g.preventDefault();var h=$(this).closest(".pagination").attr("data-addition"),f=$(this).closest("ul").attr("data-wrapSelector");h=JSON.parse(h);h.action="pagination";h=JSON.stringify(h);var d=(f)?$(f):false;c(h,$(this),$(this).attr("href"),d)}).on("keyup focusout",".search-ajax-field",function(g){if((g.type==="keyup"&&g.keyCode===13)||g.type==="focusout"){g.preventDefault();var h=$(this).attr("data-addition"),f=$(this).attr("data-wrap"),d=(f)?$(f):false;h=JSON.parse(h);h=(h.length===0)?{}:h;h.action="search";h.search=$(this).val();h=JSON.stringify(h);c(h,$(this),$(this).attr("data-href"),d)}}).on("click change",".filter-ajax-tabs",function(i){var f=$(this).attr("name"),h=$(this).val(),g=$(this).closest(".filter-tab-info"),j=g.attr("data-addition"),d=g.attr("data-href");j=JSON.parse(j);j[f]=h;j=JSON.stringify(j);c(j,$(this),d)}).on("change","form.ajax-reload-filter",function(i){var g=$(this),j=g.attr("data-addition"),h=g.serializeArray(),f=g.attr("data-wrapSelector");j=JSON.parse(j);j.filter=h;j=JSON.stringify(j);var d=(f)?$(f):false;c(j,$(this),g.attr("action"),d)});function c(g,e,d,f){if(!d||d===undefined){return false}$.ajax({url:d,type:"POST",data:{data:g},success:function(h){if(h){f=(f)?f:e.closest(".tab-pane");f.empty().append(h);if(typeof initSwitcheries==="function"){initSwitcheries()}}}})}function b(m){var j=m.target.files;var g=$(m.target),l=g.closest(".form-group").next(".image-input-preview-block").empty();for(var h=0,k;k=j[h];h++){if(!k.type.match("image.*")){alert("Image only please....")}var d=new FileReader();d.onload=(function(e){return function(i){var f='<div class="col-md-4 col-xs-12"><div class="example">';f+='<img class="img-rounded img-bordered img-bordered-primary" src="'+i.target.result+'" title="'+e.name+'">';f+="</div></div>";l.append(f)}})(k);d.readAsDataURL(k)}}$("body").on("change",".image-input-with-preview",b);$("body").on("click","a.link-disallow",function(f){f.preventDefault();var d=$(this).attr("href");$.ajax({url:"/site/ajax-sign?type=login",success:function(g){if(g){var e=$("#ajaxSignModal");e.remove();$("body").append(g);$("#ajaxSignModal").attr("data-href",d).modal()}},error:function(e,h,g){console.log("Ошибка '"+e.status+"' (textStatus: '"+h+"', errorThrown: '"+g+"')")}})}).on("submit","#ajaxSignModal form",function(i){i.preventDefault();var h=$(this),f=$(this).serialize(),g=h.closest("#ajaxSignModal"),d=h.attr("data-type");$.ajax({url:"/site/ajax-sign?action=send&type="+d,type:"POST",data:f,success:function(k){if(k){k=JSON.parse(k);var j=k.content;if(k.success){h.closest(".ajax-content-block").replaceWith(j);var e=g.attr("data-href");if(!!e){window.location.href=e}else{g.modal("hide");g.remove()}}else{h.closest(".ajax-content-block").replaceWith(j)}}}})}).on("click","#ajaxSignModal .ajax-sign-toggle",function(g){g.preventDefault();var d=$(this),f=d.attr("data-type");$.ajax({url:"/site/ajax-sign?action=toggle&type="+f,success:function(e){if(e){d.closest(".ajax-content-block").replaceWith(e)}}})})});