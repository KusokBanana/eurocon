$(document).ready(function(){$("body").on("submit","#forum_add_post_form",function(d){d.preventDefault();var c=$(this),a=c.attr("action");var b=new FormData(c[0]);b.append("image_files",c.find('input[type="file"]').prop("files")[0]);$.ajax({url:a,data:b,type:"POST",processData:false,contentType:false,success:function(e){if(e){$("#forum").empty().append(e);c[0].reset();c.closest(".modal").modal("hide")}}})});$("#forum").on("click",".forum-post-reply",function(b){b.preventDefault();var a=$("#"+$(this).attr("data-target"));$(".comment-form").not(a).hide();if(a.is(":hidden")){a.slideToggle("slow")}}).on("click",".comment-form-close",function(a){$(this).closest("form").slideUp("slow")}).on("submit","form.comment-form",function(d){d.preventDefault();var b=$(this),f=b.find("textarea").val(),a=b.attr("action"),c=b.attr("data-target");if(!f||!a){return false}$.ajax({url:a,data:{text:f},method:"POST",success:function(i){if(i){var k=$("#"+c);k.empty().append(i);b.find("textarea").val("");var h=k.find("form");var j=h.attr("data-comments_count"),g=h.closest(".forum-post").find(".forum-see-all"),e=g.attr("data-comments_count",j).text();e=e.replace(/(\d)/,j);g.text(e)}}})}).on("click",".forum-get-replies",function(i){i.preventDefault();var b=$(this).attr("href"),h=$(this).attr("data-target"),a=$(this).attr("data-loaded");if(!a){$.ajax({url:b,method:"GET",success:function(e){if(e){$("#"+h).empty().append(e).slideToggle("slow");$(this).attr("data-loaded",true)}}})}var d=$("#"+h).find("form");if(d.length){var g=d.attr("data-comments_count")}else{g=$(this).attr("data-comments_count")}var f=$(this).attr("data-title").replace(/(\d)/,g),c=$(this).text().replace(/(\d)/,g);$(this).attr("data-title",c);$(this).text(f);if(a){d.slideToggle("slow")}})});